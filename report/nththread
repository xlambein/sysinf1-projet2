for i = start, i*i <= toFact, i += step:

    if i divides toFact:

        lock mut_toFact
            if i divides toFact:
                push i to heap
                divide toFact by i
            end
        unlock mut_toFact

    end

end
